# 기획서 기반 개발 워크플로우

> 기획서를 받아서 기능을 개발하는 전체 프로세스를 정의합니다.

---

## 🔄 전체 프로세스

```
기획서 전달 → 유형 분석 → 계획 수립 → 사용자 확인 → 구현 → 보고
```

---

## 1단계: 기획서 유형 분석

### 유형 A: 기능 수정 (Feature Fix/Enhancement)

**판단 기준:**
- ✅ 기존 기능의 버그 수정
- ✅ 기존 기능의 성능 개선
- ✅ 기존 기능의 사용성 개선
- ✅ 리팩토링 (기능 변화 없음)
- ✅ 호환성 이슈 수정

**분석 체크리스트:**
- [ ] 영향받는 Feature ID 확인
- [ ] 영향받는 파일 목록 (Models/ViewModels/Services/Processors)
- [ ] 영향받는 UI 요소
- [ ] 호환성 고려사항
- [ ] 기존 데이터 호환성 여부
- [ ] 테스트 방법

**자동 판단 키워드:**
- "버그", "오류", "수정", "개선", "최적화", "리팩토링"

---

### 유형 B: 새로운 기능 추가 (New Feature)

**판단 기준:**
- ✅ 완전히 새로운 카테고리
- ✅ 기존 카테고리의 새로운 프로세서
- ✅ 새로운 UI 요소 추가
- ✅ 새로운 데이터 모델 필요
- ✅ 새로운 API 추가

**분석 체크리스트:**
- [ ] 필요한 카테고리 결정 (StaticData/Logic/SchemaGen/Enum/Constants)
- [ ] 새로운 Processor 필요 여부
- [ ] 새로운 ViewModel 필요 여부
- [ ] 새로운 View 필요 여부
- [ ] FDF 설정 요구사항
- [ ] 템플릿 요구사항
- [ ] UI 흐름

**자동 판단 키워드:**
- "신규", "추가", "생성", "새로운", "기능", "프로세서"

---

## 2단계: 계획 수립

### 기능 수정 계획 템플릿

```markdown
## 📋 기능 수정 계획

### 문제 정의
- **현재 동작**: ...
- **예상 동작**: ...
- **발생 상황**: ...

### 수정 범위
- **영향 파일**:
  - Services/ExportService.cs
  - ViewModels/MainViewModel.cs
- **수정 라인**: ...
- **테스트 방법**: ...

### 위험 요소
- [ ] 호환성 문제
- [ ] 데이터 무결성 영향
- [ ] 성능 영향

### 예상 소요 시간
...

### 우선순위
- [ ] High
- [ ] Medium
- [ ] Low
```

---

### 새로운 기능 계획 템플릿

```markdown
## 📋 새로운 기능 추가 계획

### 기능 개요
- **기능 이름**: ...
- **카테고리**: (StaticData/Logic/SchemaGen/Enum/Constants)
- **설명**: ...

### 구현 파일
- [ ] Models/Models/FeatureDefinition.cs 수정 (필요 시)
- [ ] Services/Processors/NewFeatureProcessor.cs 생성
- [ ] ViewModels/NewFeatureExecutionViewModel.cs 생성
- [ ] Views/ExecutionItems/NewFeatureExecutionView.xaml 생성
- [ ] .guides/CODE_STYLE.md 업데이트 (새 패턴 추가 시)

### FDF 설정
- **필요한 경로 설정**: ...
- **필요한 템플릿**: ...

### UI 변경사항
- **새로운 화면**: ...
- **기존 화면 수정**: ...

### 구현 순서
1. Model 정의
2. Processor 구현
3. ViewModel 생성
4. View 생성
5. FeatureBuilder 통합
6. 테스트

### 위험 요소
...

### 예상 소요 시간
...
```

---

## 3단계: 사용자 확인

### 확인 형식

```
✅ 계획이 수립되었습니다.

[WorkID]: WIP-YYYYMMDD-NN
[유형]: (기능 수정 / 새로운 기능)

[계획 요약]
...

[영향 파일]
...

[위험 요소]
...

진행하시겠습니까? (y/n 또는 수정 요청)
```

### 확인 대기 시 에이전트 동작
- 사용자 "y" → 즉시 구현 시작
- 사용자 "n" → 취소 사유 문의
- 사용자 "수정 요청" → 계획 수정 후 재확인

---

## 4단계: 구현 및 추적

### WORK_IN_PROGRESS.md 업데이트

**작업 시작 시:**
```markdown
### WIP-YYYYMMDD-NN: [작업 제목]

#### 📋 계획 요약
- **유형**: (수정/신규)
- **시작일**: 2025-02-02
- **파일**: ...

#### ✅ 완료 단계
- [x] 기획서 분석
- [x] 계획 수립
- [x] 사용자 확인
- [ ] 구현 단계별 항목...

#### 🔗 관련 파일
- ...

#### 💬 사용자 메모
...
```

**진행 중 업데이트:**
```markdown
#### 🚧 진행 상황
2025-02-02 15:30: ExportService.cs:20 null 체크 추가 완료
```

---

## 4-1단계: 자동 업데이트 시스템

### 원칙
**에이전트는 모든 작업 단계에서 자동으로 WORK_IN_PROGRESS.md를 업데이트합니다.**

사용자가 별도 업데이트 지시할 필요가 없습니다!

---

### 업데이트 규칙

#### 1. 작업 시작 시
```
사용자: "신규: CSV 데이터 추출 기능"
```

에이전트 자동 작업:
```markdown
1. WorkID 생성: WIP-20250202-001
2. WORK_IN_PROGRESS.md "활성 작업"에 자동 추가
3. 해당 WorkID 상세 섹션 자동 생성
```

WORK_IN_PROGRESS.md 업데이트 (자동):
```markdown
### 활성 작업 (진행 중)
| WorkID | 상태 | 유형 | 제목 | 시작일 | 진척도 |
|--------|------|------|------|--------|--------|
| WIP-20250202-001 | ⏸️ 진행 중 | 신규 | CSV 데이터 추출 | 2025-02-02 | 0% |

### WIP-20250202-001: CSV 데이터 추출

#### 📋 계획 요약
- **유형**: 신규
- **시작일**: 2025-02-02

#### ✅ 완료 단계
- [ ] 기획서 분석
- [ ] 계획 수립
- [ ] 사용자 확인
```

---

#### 2. 각 단계 완료 시

**기획서 분석 완료:**
```markdown
- [x] 기획서 분석
```

**계획 수립 완료:**
```markdown
- [x] 기획서 분석
- [x] 계획 수립
```

**사용자 확인 완료:**
```markdown
- [x] 기획서 분석
- [x] 계획 수립
- [x] 사용자 확인
```

---

#### 3. 구현 진행 중 (실시간)

**파일 생성 완료:**
```markdown
#### 🚧 진행 상황
2025-02-02 10:15: CSVProcessor.cs 생성 완료
2025-02-02 10:30: CSVExecutionViewModel.cs 생성 완료
```

**각 파일 수정 완료:**
```markdown
#### 🚧 진행 상황
2025-02-02 11:00: CSVProcessor.cs 구현 완료 (150줄)
2025-02-02 11:30: CSVExecutionViewModel.cs 구현 완료 (80줄)
```

---

#### 4. 작업 완료 시

사용자: "완료: WIP-20250202-001"

에이전트 자동 작업:
```markdown
1. 완료 단계 모두 체크
2. WORK_IN_PROGRESS.md "완료 작업"으로 자동 이동
3. "활성 작업"에서 자동 제거
4. WORK_HISTORY.json에 자동 추가
```

WORK_IN_PROGRESS.md 업데이트 (자동):
```markdown
### 활성 작업 (진행 중)
*(WIP-20250202-001 제거됨)*

### 완료 작업 (히스토리)
| WorkID | 완료일 | 유형 | 제목 | 소요시간 |
|--------|--------|------|------|----------|
| WIP-20250202-001 | 2025-02-02 | 신규 | CSV 데이터 추출 | 6.5h |

### 완료된 작업 상세

#### WIP-20250202-001: CSV 데이터 추출

**완료일:** 2025-02-02 16:30
**소요 시간:** 6.5시간
**커밋:** abc123

[전체 내용 보존...]
```

---

#### 5. 작업 취소 시

사용자: "취소: WIP-20250202-001 우선순위 조정으로 인해"

에이전트 자동 작업:
```markdown
1. WORK_IN_PROGRESS.md "취소 작업"으로 자동 이동
2. "활성 작업"에서 자동 제거
3. 취소 사유 기록
```

WORK_IN_PROGRESS.md 업데이트 (자동):
```markdown
### 활성 작업 (진행 중)
*(WIP-20250202-001 제거됨)*

### 취소된 작업 (취소 히스토리)
| WorkID | 취소일 | 유형 | 제목 | 사유 |
|--------|--------|------|------|------|
| WIP-20250202-001 | 2025-02-02 15:00 | 신규 | CSV 데이터 추출 | 우선순위 조정 |
```

---

### 전체 프로세스 요약

```
사용자 지시: "신규: CSV 데이터 추출"
     ↓
에이전트: WorkID 생성 → WORK_IN_PROGRESS.md 추가
     ↓
[자동] 기획서 분석 완료 → 체크박스 체크
     ↓
[자동] 계획 수립 완료 → 체크박스 체크
     ↓
사용자: "y" (확인)
     ↓
[자동] 사용자 확인 완료 → 체크박스 체크
     ↓
[자동] 파일 생성 → 진행 상황 타임스탬프
     ↓
[자동] 구현 완료 → 진행 상황 타임스탬프
     ↓
[자동] 빌드/테스트 완료 → 체크박스 체크
     ↓
사용자: "완료: WIP-20250202-001"
     ↓
[자동] 완료 작업으로 이동 → 완료 정보 기록
     ↓
[자동] WORK_HISTORY.json 업데이트
```

---

### 에이전트 체크리스트

#### 작업 시작 시
- [x] WorkID 자동 생성
- [x] WORK_IN_PROGRESS.md "활성 작업"에 추가
- [x] 상세 섹션 자동 생성

#### 단계 완료 시 (각 단계)
- [x] 완료 단계 체크박스 자동 체크
- [x] 진행 상황 타임스탬프 기록
- [ ] 사용자에게 진행 상황 보고 (선택 사항)

#### 작업 완료 시
- [x] 모든 완료 단계 체크
- [x] 완료 작업으로 자동 이동
- [x] 활성 작업에서 자동 제거
- [x] WORK_HISTORY.json 자동 추가

#### 작업 취소 시
- [x] 취소 작업으로 자동 이동
- [x] 활성 작업에서 자동 제거
- [x] 취소 사유 기록

---

### 사용자 역할

**사용자는 다음 지시만 하면 됩니다:**
```
"신규: 기능 설명"           # 새 작업 시작
"수정: 파일:라인 문제"      # 기능 수정
"기획: 파일경로"            # 기획서 처리
"완료: WIP-XXX"            # 작업 완료
"취소: WIP-XXX 사유"        # 작업 취소
```

**에이전트가 자동으로:**
- WORK_IN_PROGRESS.md 업데이트
- 단계 추적
- 완료/취소 처리

---

## 5단계: 구현 및 보고

### 완료 보고 형식

```
✅ 작업 완료!

[WorkID]: WIP-YYYYMMDD-NN
[완료일]: 2025-02-02 16:30
[소요 시간]: 6.5시간

[수정/생성 파일]
- Services/ExportService.cs (수정: 20번 라인 null 체크 추가)
- ...

[테스트 결과]
- [x] 빌드 성공
- [x] 기능 테스트 통과

[커밋]
[fix] ExportService null 체크 추가

[다음 단계]
- WORK_IN_PROGRESS.md 업데이트 (완료 작업으로 이동)
- 필요 시 보고서 생성
```

---

## 📌 에이전트용 지시 단축

### 기능 수정 요청
```
수정: [파일명] [문제 설명]
또는
수정: ExportService.cs:20 null 체크 추가
```
→ 유형A 분석 → 계획 → 확인 → 구현

---

### 새로운 기능 요청
```
신규: [기능 설명]
또는
신규: CSV 데이터 추출 기능 추가
```
→ 유형B 분석 → 계획 → 확인 → 구현

---

### 기획서 파일 전달
```
기획: [파일경로]
또는
기획: ./docs/planning/feature_001.md
```
→ 파일 읽기 → 분석 → 계획 → 확인 → 구현

---

### 기획서 내용 직접 전달
```
기획: "엑셀 데이터를 CSV 형식으로도 추출 가능하게 해줘"
```
→ 텍스트 분석 → 유형 판단 → 계획 → 확인 → 구현

---

## 🎯 자동 유형 판단 로직

### 키워드 기반 판단

| 입력 내용 | 유형 | 이유 |
|-----------|------|------|
| "버그", "오류", "fix" | 수정 | 문제 해결 |
| "개선", "최적화", "refactor" | 수정 | 향상 |
| "신규", "추가", "create", "new" | 신규 | 새로운 것 |
| "프로세서", "processor" | 신규 | 새 컴포넌트 |
| "화면", "UI" | 신규 | UI 요소 |

### 애매한 경우
- 기존 기능과 관련 있으면 "수정"
- 완전히 새로운 것이면 "신규"
- 확실하지 않으면 사용자에게 문의

---

## 🔍 분석 예시

### 예시 1: 기능 수정
```
사용자: "수정: ExportService에서 null 참조 버그 수정"

에이전트:
1. 유형: 기능 수정 (버그 수정)
2. 영향 파일: Services/ExportService.cs
3. 위험: 데이터 무결성 영향 가능
4. 계획 수립
5. 사용자 확인 요청
```

---

### 예시 2: 새로운 기능
```
사용자: "신규: CSV 데이터 추출 기능 추가"

에이전트:
1. 유형: 새로운 기능
2. 카테고리: StaticData (기존 카테고리 확장)
3. 필요 파일:
   - Services/Processors/CSVProcessor.cs (신규)
   - ViewModels/CSVExecutionViewModel.cs (신규)
   - Views/ExecutionItems/CSVExecutionView.xaml (신규)
4. 계획 수립
5. 사용자 확인 요청
```

---

### 예시 3: 기획서 파일
```
사용자: "기획: ./docs/planning/export_enhancement.md"

에이전트:
1. 파일 읽기
2. 내용 분석
3. 유형 판단 (문서에 명시되어 있으면 따름)
4. 계획 수립
5. 사용자 확인 요청
```

---

## 6단계: 보고서 생성 (선택 사항)

### 보고서 명령어
```
보고서: WIP-YYYYMMDD-NN
```

### 보고서 형식

#### JSON 형식 (WORK_HISTORY.json)
```json
{
  "completed_works": [
    {
      "workId": "WIP-20250202-001",
      "type": "수정",
      "title": "ExportService null 체크 추가",
      "startDate": "2025-02-02T10:00:00",
      "endDate": "2025-02-02T16:30:00",
      "duration": "6.5h",
      "files": [
        "Services/ExportService.cs"
      ],
      "commit": "abc123",
      "tags": ["fix", "data-integrity"]
    }
  ],
  "cancelled_works": [
    {
      "workId": "WIP-20250130-002",
      "type": "수정",
      "title": "ExportService 최적화",
      "startDate": "2025-01-30T14:00:00",
      "cancelledDate": "2025-01-30T15:30:00",
      "reason": "우선순위 조정",
      "duration": "1.5h"
    }
  ]
}
```

#### 마크다운 형식 (reports/WORK_REPORT_WIP-YYYYMMDD-NN.md)
```markdown
# 작업 보고서

## 작업 정보
- **WorkID**: WIP-20250202-001
- **유형**: 기능 수정
- **제목**: ExportService null 체크 추가

## 기간
- **시작**: 2025-02-02 10:00
- **완료**: 2025-02-02 16:30
- **소요 시간**: 6.5시간

## 계획 요약
- [x] 기획서 분석
- [x] 계획 수립
- [x] 사용자 확인
- [x] 구현
- [x] 테스트
- [x] 커밋

## 구현 내용
- Services/ExportService.cs
  - 20번 라인: null 체크 추가
  - 45번 라인: 예외 메시지 개선

## 변경 파일
- Services/ExportService.cs

## 커밋
- [fix] ExportService null 체크 추가
- Hash: abc123def456

## 테스트 결과
- [x] 단위 테스트 통과
- [x] 빌드 성공
- [x] 기능 테스트 통과

## 노트
- 데이터 무결성 원칙 준수
- 예외 발생 시 명확한 메시지 제공
```

### 내보내기 명령어
```
내보내기: json
→ WORK_HISTORY.json 업데이트

내보내기: markdown
→ reports/WORK_REPORT_WIP-YYYYMMDD-NN.md 생성
```

---

## 📚 관련 문서

- [프로젝트 요약](PROJECT_SUMMARY.md)
- [작업 추적](WORK_IN_PROGRESS.md)
- [빠른 참조](QUICK_REFERENCE.md)
- [코드 스타일](.guides/CODE_STYLE.md)
- [기술 규칙](.guides/TECHNICAL_RULES.md)
